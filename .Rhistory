year <- year %>%
pivot_longer(cols = c("NL", "FLE", "FOF","FLCC"),
names_to = "Event", values_to = "DOY")
View(year)
#boxplots of day of year start of phenophase faceted by phase
year$Elevation <- as.factor(year$Elevation)
year$Year <- as.factor(year$Year)
nl <- year%>%
filter(Event == "NL")%>%
ggplot(aes(Elevation, DOY, color = Year))+
geom_boxplot()+
theme_bw()+
#scale_y_continuous(limits = c(-60, 60))+
labs(title = "Timing of New Leaves", y = "Julian Day of Year")
nl
fle <- year%>%
filter(Event == "FLE")%>%
ggplot(aes(Elevation, DOY, color = Year))+
geom_boxplot()+
theme_bw()+
#scale_y_continuous(limits = c(-60, 60))+
labs(title = "Timing of New Leaves", y = "Julian Day of Year")
fle
fof <- year%>%
filter(Event == "FOF")%>%
ggplot(aes(Elevation, DOY, color = Year))+
geom_boxplot()+
theme_bw()+
#scale_y_continuous(limits = c(-60, 60))+
labs(title = "Timing of New Leaves", y = "Julian Day of Year")
fof
flcc <- year%>%
filter(Event == "FLCC")%>%
ggplot(aes(Elevation, DOY, color = Year))+
geom_boxplot()+
theme_bw()+
#scale_y_continuous(limits = c(-60, 60))+
labs(title = "Timing of New Leaves", y = "Julian Day of Year")
flcc
library(ggpubr)
ggarrange(nl, fle, fof, flcc, common.legend = T, legend = "right")
fle <- year%>%
filter(Event == "FLE")%>%
ggplot(aes(Elevation, DOY, color = Year))+
geom_boxplot()+
theme_bw()+
#scale_y_continuous(limits = c(-60, 60))+
labs(title = "Timing of Full Leaf Expansion", y = "Julian Day of Year")
fle
fof <- year%>%
filter(Event == "FOF")%>%
ggplot(aes(Elevation, DOY, color = Year))+
geom_boxplot()+
theme_bw()+
#scale_y_continuous(limits = c(-60, 60))+
labs(title = "Timing of First Open Flower", y = "Julian Day of Year")
fof
flcc <- year%>%
filter(Event == "FLCC")%>%
ggplot(aes(Elevation, DOY, color = Year))+
geom_boxplot()+
theme_bw()+
#scale_y_continuous(limits = c(-60, 60))+
labs(title = "Timing of Full Leaf Color Change", y = "Julian Day of Year")
flcc
ggarrange(nl, fle, fof, flcc, common.legend = T, legend = "right")
####TRMT####
#reorder dataset to be longer (events are in an 'event' column instead of columns of their own)
treatment <- treatment %>%
pivot_longer(cols = c("NL", "FLE", "FOF","FLCC"),
names_to = "Event", values_to = "DOY")
View(treatment)
View(treatment)
nl <- treatment%>%
filter(Event == "NL")%>%
ggplot(aes(Elevation, DOY, color = Year))+
geom_boxplot()+
theme_bw()+
#scale_y_continuous(limits = c(-60, 60))+
labs(title = "Timing of New Leaves", y = "Julian Day of Year")
nl <- treatment%>%
filter(Event == "NL")%>%
ggplot(aes(Elevation, DOY, color = Treatment))+
geom_boxplot()+
theme_bw()+
#scale_y_continuous(limits = c(-60, 60))+
labs(title = "Timing of New Leaves", y = "Julian Day of Year")
nl
treatment$Treatment <- as.factor(treatment$Treatment)
nl <- treatment%>%
filter(Event == "NL")%>%
ggplot(aes(Elevation, DOY, color = Treatment))+
geom_boxplot()+
theme_bw()+
#scale_y_continuous(limits = c(-60, 60))+
labs(title = "Timing of New Leaves", y = "Julian Day of Year")
nl
View(treatment)
treatment$Elevation <- as.factor(treatment$Elevation)
nl <- treatment%>%
filter(Event == "NL")%>%
ggplot(aes(Elevation, DOY, color = Treatment))+
geom_boxplot()+
theme_bw()+
#scale_y_continuous(limits = c(-60, 60))+
labs(title = "Timing of New Leaves", y = "Julian Day of Year")
nl
fle <- treatment%>%
filter(Event == "FLE")%>%
ggplot(aes(Elevation, DOY, color = Treatment))+
geom_boxplot()+
theme_bw()+
#scale_y_continuous(limits = c(-60, 60))+
labs(title = "Timing of Full Leaf Expasion", y = "Julian Day of Year")
fle
fof <- treatment%>%
filter(Event == "FOF")%>%
ggplot(aes(Elevation, DOY, color = Treatment))+
geom_boxplot()+
theme_bw()+
#scale_y_continuous(limits = c(-60, 60))+
labs(title = "Timing of First Open Flower", y = "Julian Day of Year")
fof
flcc <- treatment%>%
filter(Event == "FLCC")%>%
ggplot(aes(Elevation, DOY, color = Treatment))+
geom_boxplot()+
theme_bw()+
#scale_y_continuous(limits = c(-60, 60))+
labs(title = "Timing of Full Leaf Color Change", y = "Julian Day of Year")
flcc
nl <- treatment%>%
filter(Event == "NL")%>%
ggplot(aes(Elevation, DOY, color = Treatment))+
geom_boxplot()+
theme_bw()+
scale_y_continuous(limits = c(100, 250))+
labs(title = "Timing of New Leaves", y = "Julian Day of Year")
fle <- treatment%>%
filter(Event == "FLE")%>%
ggplot(aes(Elevation, DOY, color = Treatment))+
geom_boxplot()+
theme_bw()+
scale_y_continuous(limits = c(100, 250))+
labs(title = "Timing of Full Leaf Expasion", y = "Julian Day of Year")
fof <- treatment%>%
filter(Event == "FOF")%>%
ggplot(aes(Elevation, DOY, color = Treatment))+
geom_boxplot()+
theme_bw()+
scale_y_continuous(limits = c(100, 250))+
labs(title = "Timing of First Open Flower", y = "Julian Day of Year")
flcc <- treatment%>%
filter(Event == "FLCC")%>%
ggplot(aes(Elevation, DOY, color = Treatment))+
geom_boxplot()+
theme_bw()+
scale_y_continuous(limits = c(100, 250))+
labs(title = "Timing of Full Leaf Color Change", y = "Julian Day of Year")
ggarrange(nl, fle, fof, flcc, common.legend = T, legend = "right")
nl <- year%>%
filter(Event == "NL")%>%
ggplot(aes(Elevation, DOY, color = Year))+
geom_boxplot()+
theme_bw()+
#scale_y_continuous(limits = c(-60, 60))+
labs(title = "Timing of New Leaves", y = "Julian Day of Year")
nl
fle <- year%>%
filter(Event == "FLE")%>%
ggplot(aes(Elevation, DOY, color = Year))+
geom_boxplot()+
theme_bw()+
#scale_y_continuous(limits = c(-60, 60))+
labs(title = "Timing of Full Leaf Expansion", y = "Julian Day of Year")
fle
fof <- year%>%
filter(Event == "FOF")%>%
ggplot(aes(Elevation, DOY, color = Year))+
geom_boxplot()+
theme_bw()+
#scale_y_continuous(limits = c(-60, 60))+
labs(title = "Timing of First Open Flower", y = "Julian Day of Year")
fof
flcc <- year%>%
filter(Event == "FLCC")%>%
ggplot(aes(Elevation, DOY, color = Year))+
geom_boxplot()+
theme_bw()+
#scale_y_continuous(limits = c(-60, 60))+
labs(title = "Timing of Full Leaf Color Change", y = "Julian Day of Year")
flcc
nl <- year%>%
filter(Event == "NL")%>%
ggplot(aes(Elevation, DOY, color = Year))+
geom_boxplot()+
theme_bw()+
scale_y_continuous(limits = c(100, 300))+
labs(title = "Timing of New Leaves", y = "Julian Day of Year")
fle <- year%>%
filter(Event == "FLE")%>%
ggplot(aes(Elevation, DOY, color = Year))+
geom_boxplot()+
theme_bw()+
scale_y_continuous(limits = c(100, 300))+
labs(title = "Timing of Full Leaf Expansion", y = "Julian Day of Year")
fof <- year%>%
filter(Event == "FOF")%>%
ggplot(aes(Elevation, DOY, color = Year))+
geom_boxplot()+
theme_bw()+
scale_y_continuous(limits = c(100, 300))+
labs(title = "Timing of First Open Flower", y = "Julian Day of Year")
flcc <- year%>%
filter(Event == "FLCC")%>%
ggplot(aes(Elevation, DOY, color = Year))+
geom_boxplot()+
theme_bw()+
scale_y_continuous(limits = c(100, 300))+
labs(title = "Timing of Full Leaf Color Change", y = "Julian Day of Year")
ggarrange(nl, fle, fof, flcc, common.legend = T, legend = "right")
View(year)
####YEAR SCATTER####
lm <- year%>%
filter(Site == "LM")%>%
ggplot(aes(DOYsf, DOY, color = Event))+
geom_point()
lm
ggplot(year, aes(DOYsf, DOY, color = Event, shape = Site))+
geom_point()
ggplot(year, aes(DOYsf, DOY, color = Site, shape = Event))+
geom_point()
ggplot(year, aes(DOYsf, DOY, color = Event, shape = Site))+
geom_point()
####YEAR SCATTER####
nl <- year%>%
filter(Event == "NL")%>%
ggplot(aes(DOYsf, DOY, color = Site))+
geom_point()
nl
####YEAR SCATTER####
nl <- year%>%
filter(Event == "NL")%>%
ggplot(aes(DOYsf, DOY, color = Site))+
geom_point()+
theme_bw()+
labs(title = "New Leaves")
nl
####YEAR SCATTER####
year$Site <- factor(year$Site, levels = c("LM", "UM", "LSA", "USA", "ALP"))
nl <- year%>%
filter(Event == "NL")%>%
ggplot(aes(DOYsf, DOY, color = Site))+
geom_point()+
theme_bw()+
labs(title = "New Leaves")
nl
fle <- year%>%
filter(Event == "FLE")%>%
ggplot(aes(DOYsf, DOY, color = Site))+
geom_point()+
theme_bw()+
labs(title = "New Leaves")
fle
fof <- year%>%
filter(Event == "FOF")%>%
ggplot(aes(DOYsf, DOY, color = Site))+
geom_point()+
theme_bw()+
labs(title = "New Leaves")
fof
flcc <- year%>%
filter(Event == "FLCC")%>%
ggplot(aes(DOYsf, DOY, color = Site))+
geom_point()+
theme_bw()+
labs(title = "New Leaves")
flcc <- year%>%
filter(Event == "FLCC")%>%
ggplot(aes(DOYsf, DOY, color = Site))+
geom_point()+
theme_bw()+
labs(title = "Full Leaf Color Change")
flcc
fle <- year%>%
filter(Event == "FLE")%>%
ggplot(aes(DOYsf, DOY, color = Site))+
geom_point()+
theme_bw()+
labs(title = "Full Leaf Expansion")
fle
fof <- year%>%
filter(Event == "FOF")%>%
ggplot(aes(DOYsf, DOY, color = Site))+
geom_point()+
theme_bw()+
labs(title = "First Open Flower")
fof
flcc <- year%>%
filter(Event == "FLCC")%>%
ggplot(aes(DOYsf, DOY, color = Site))+
geom_point()+
theme_bw()+
labs(title = "Full Leaf Color Change")
flcc
ggarrange(nl, fle, fof, flcc, common.legend = T, legend = "right")
####TRMT SCATTER####
treatment$Site <- factor(treatment$Site, c("LM", "UM", "LSA", "USA", "ALP"))
fle <- treatment%>%
filter(Event == "FLE")%>%
ggplot(aes(DOYsf, DOY, color = Site))+
geom_point()+
theme_bw()+
labs(title = "Full Leaf Expansion")
fle
fof <- treatment%>%
filter(Event == "FOF")%>%
ggplot(aes(DOYsf, DOY, color = Site))+
geom_point()+
theme_bw()+
labs(title = "First Open Flower")
fof
flcc <- treatment%>%
filter(Event == "FLCC")%>%
ggplot(aes(DOYsf, DOY, color = Site))+
geom_point()+
theme_bw()+
labs(title = "Full Leaf Color Change")
flcc
nl <- treatment%>%
filter(Event == "NL")%>%
ggplot(aes(DOYsf, DOY, color = Site))+
geom_point()+
theme_bw()+
labs(title = "New Leaves")
nl
ggarrange(nl, fle, fof, flcc, common.legend = T, legend = "right")
rm(list = ls())
## Date: 2021-02-18
## User: Chelsea Wilmer
## SFA/CSU Thesis
## Script: percent species early graphs for elevations
## Packages:
library(tidyverse)
library(ggpubr)
####Bring in phenology data####
source("/Users/chelseawilmer/Desktop/Github/Phenology/Phenology.data.cleanup.R")
#remove columns that we don't need
pheno <- select(pheno, -c(Duplicate.Plot, FBB, FLB, Plot))
#filter pheno dataset for the control plots to make effect of the year dataset
year <- filter(pheno, Treatment == "Control")
#filter pheno dataset for 2018 to make the effect of the treatment dataset
treatment <- filter(pheno, Year == 2018)
treatment <- filter(treatment, Site == "LM" | Site == "UM" | Site == "LSA" | Site == "USA")
####YEAR####
#reorder dataset to be longer (events are in an 'event' column instead of columns of their own)
year <- year %>%
pivot_longer(cols = c("NL", "FLE", "FOF","FLCC"),
names_to = "Event", values_to = "DOY")
#average over subplots
year <- year%>%
group_by(Year, Site, Block, Treatment, Species, EOS, Event)%>%
summarise(meanDOY = mean(DOY, na.rm = T))
year <- year%>%
group_by(Year, Site, Treatment, Species, EOS, Event)%>%
summarise(meanDOY = mean(meanDOY, na.rm = T))
year <- year%>%
group_by(Year, Site, Treatment, EOS, Event)%>%
summarise(meanDOY = mean(meanDOY, na.rm = T))
year_duration <- year%>%
pivot_wider(names_from = Event, values_from = meanDOY)
year_duration$NL <- year_duration$FLE - year_duration$NL
year_duration$FLE <- year_duration$FOF - year_duration$FLE
year_duration$FOF <- year_duration$FLCC - year_duration$FOF
year_duration$FLCC <- year_duration$EOS - year_duration$FLCC
year_duration <- year_duration%>%
pivot_longer(cols = c("NL", "FLE", "FOF", "FLCC"),
names_to = "Event", values_to = "Duration")
year <- year%>%
group_by(Year, Site, Event)%>%
summarise(meanDOY = mean(meanDOY, na.rm = T))
year_duration <- year_duration%>%
group_by(Year, Site, Event)%>%
summarise(Duration = mean(Duration, na.rm = T))
#reorder dataset to be longer (events are in an 'event' column instead of columns of their own)
treatment <- treatment%>%
group_by(Site, Block, Treatment, EOS, Species)%>%
summarise(NL = mean(NL, na.rm = T),
FLE = mean(FLE, na.rm = T),
FOF = mean(FOF, na.rm = T),
FLCC = mean(FLCC, na.rm = T))
treatment <- treatment %>%
pivot_longer(cols = c("NL", "FLE", "FOF","FLCC"),
names_to = "Event", values_to = "DOY")
#calculate means by block
treatment <- treatment%>%
group_by(Site, Block, Treatment, Species, EOS, Event)%>%
summarise(meanDOY = mean(DOY, na.rm = T))
treatment <- treatment%>%
group_by(Site, Treatment, Species, EOS, Event)%>%
summarise(meanDOY = mean(meanDOY, na.rm = T))
treatment <- treatment%>%
group_by(Site, Treatment, EOS, Event)%>%
summarise(meanDOY = mean(meanDOY, na.rm = T))
treatment_duration <- treatment%>%
pivot_wider(names_from = Event, values_from = meanDOY)
treatment_duration$NL <- treatment_duration$FLE - treatment_duration$NL
treatment_duration$FLE <- treatment_duration$FOF - treatment_duration$FLE
treatment_duration$FOF <- treatment_duration$FLCC - treatment_duration$FOF
treatment_duration$FLCC <- treatment_duration$EOS - treatment_duration$FLCC
treatment_duration <- treatment_duration%>%
pivot_longer(cols = c("NL", "FLE", "FOF", "FLCC"),
names_to = "Event", values_to = "Duration")
treatment <- treatment%>%
group_by(Site, Treatment, Event)%>%
summarise(meanDOY = mean(meanDOY, na.rm = T))
treatment_duration <- treatment_duration%>%
group_by(Site, Treatment, Event)%>%
summarise(Duration = mean(Duration, na.rm = T))
#combine
trmt <- left_join(treatment, treatment_duration, by = c("Site", "Treatment", "Event"))
yr <- left_join(year, year_duration, by = c("Year", "Site", "Event"))
####Timing x Duration####
#year split by event
yr$Year <- as.factor(yr$Year)
nl <- yr%>%
filter(Event == "NL")%>%
ggplot(aes(Duration, meanDOY, color = Year, shape = Site))+
geom_point()+
labs(title = "New Leaves")
nl
#year split by site
lm <- yr%>%
filter(Site == "LM")%>%
ggplot(aes(Duration, meanDOY, color = Year, shape = Event))+
geom_point()+
labs(title = "Lower Montane")
lm
#year split by site
lm <- yr%>%
filter(Site == "LM")%>%
ggplot(aes(Duration, meanDOY, color = Year, shape = Event))+
geom_point()+
scale_y_continuous(limits = c(100, 300))+
scale_x_continuous(limits = c(100, 300))+
labs(title = "Lower Montane")
lm
#year split by site
lm <- yr%>%
filter(Site == "LM")%>%
ggplot(aes(Duration, meanDOY, color = Year, shape = Event))+
geom_point()+
scale_y_continuous(limits = c(100, 300))+
scale_x_continuous(limits = c(0, 300))+
labs(title = "Lower Montane")
lm
#year split by site
lm <- yr%>%
filter(Site == "LM")%>%
ggplot(aes(Duration, meanDOY, color = Year, shape = Event))+
geom_point()+
scale_y_continuous(limits = c(0, 300))+
scale_x_continuous(limits = c(0, 300))+
labs(title = "Lower Montane")
lm
um <- yr%>%
filter(Site == "UM")%>%
ggplot(aes(Duration, meanDOY, color = Year, shape = Event))+
geom_point()+
scale_y_continuous(limits = c(0, 300))+
scale_x_continuous(limits = c(0, 300))+
labs(title = "Upper Montane")
um
lsa <- yr%>%
filter(Site == "LSA")%>%
ggplot(aes(Duration, meanDOY, color = Year, shape = Event))+
geom_point()+
scale_y_continuous(limits = c(0, 300))+
scale_x_continuous(limits = c(0, 300))+
labs(title = "Lower Subalpine")
lsa
usa <- yr%>%
filter(Site == "USA")%>%
ggplot(aes(Duration, meanDOY, color = Year, shape = Event))+
geom_point()+
scale_y_continuous(limits = c(0, 300))+
scale_x_continuous(limits = c(0, 300))+
labs(title = "Upper Subalpine")
usa
alp <- yr%>%
filter(Site == "ALP")%>%
ggplot(aes(Duration, meanDOY, color = Year, shape = Event))+
geom_point()+
scale_y_continuous(limits = c(0, 300))+
scale_x_continuous(limits = c(0, 300))+
labs(title = "Alpine")
alp
#trmt
nl <- trmt%>%
filter(Event == "NL")%>%
ggplot(aes(Duration, meanDOY, color = Treatment, shape = Site))+
geom_point()+
labs(title = "New Leaves")
#trmt
nl <- trmt%>%
filter(Event == "NL")%>%
ggplot(aes(Duration, meanDOY, color = Treatment, shape = Site))+
geom_point()+
scale_y_continuous(limits = c(0, 300))+
scale_x_continuous(limits = c(0, 300))+
labs(title = "New Leaves")
nl
