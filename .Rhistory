pheno <- filter(pheno, Site == "LM" | Site == "UM" | Site == "LSA" | Site == "USA")
#example
model1 <- lmer(NL ~ Site*Year*Treatment + Species + (1|PlotPair) + (1|Plot_ID) + (1|Subplot_ID), data = pheno)
anova(model1, ddf = "Kenward-Roger")
emmeans(model1, pairwise ~ Year|Site|Treatment)
emmeans(model1, pairwise ~ Treatment|Year|Site)
rm(list = ls())
library(lme4)
library(lmerTest)
library(car)
library(emmeans)
library(MuMIn)
source("/Users/chelseawilmer/Desktop/Github/Phenology/Phenology.data.cleanup.R")
rm(list = ls())
library(lme4)
library(lmerTest)
library(car)
library(emmeans)
library(MuMIn)
source("/Users/chelseawilmer/Desktop/Github/Phenology/Phenology.data.cleanup.R")
str(pheno)
#make variables factors
pheno$Year <- as.factor(pheno$Year)
pheno$Site <- as.factor(pheno$Site)
pheno$PlotPair <- as.factor(pheno$PlotPair)
pheno$Plot_ID <- as.factor(pheno$Plot_ID)
pheno$Subplot_ID <- as.factor(pheno$Subplot_ID)
pheno$Treatment <- as.factor(pheno$Treatment)
pheno$Species <- as.factor(pheno$Species)
pheno$Functional.Type <- as.factor(pheno$Functional.Type)
pheno$Elevation <- as.integer(pheno$Elevation)
alp <- filter(pheno, Site == "ALP")
model5 <- lmer(NL ~ Year*Treatment + Species + (1|PlotPair) + (1|Plot_ID) + (1|Subplot_ID), data = alp)
model5 <- lmer(NL ~ Year + Species + (1|PlotPair) + (1|Plot_ID) + (1|Subplot_ID), data = alp)
anova(model5, ddf = "Kenward=Roger")
anova(model5, ddf = "Kenward-Roger")
emmeans(model4, pairwise ~ Year)
emmeans(model5, pairwise ~ Year)
rm(list = ls())
library(lme4)
library(lmerTest)
library(car)
library(emmeans)
library(MuMIn)
source("/Users/chelseawilmer/Desktop/Github/Phenology/Phenology.data.cleanup.R")
str(pheno)
#make variables factors
pheno$Year <- as.factor(pheno$Year)
pheno$Site <- as.factor(pheno$Site)
pheno$PlotPair <- as.factor(pheno$PlotPair)
pheno$Plot_ID <- as.factor(pheno$Plot_ID)
pheno$Subplot_ID <- as.factor(pheno$Subplot_ID)
pheno$Treatment <- as.factor(pheno$Treatment)
pheno$Species <- as.factor(pheno$Species)
pheno$Functional.Type <- as.factor(pheno$Functional.Type)
pheno$Elevation <- as.integer(pheno$Elevation)
pheno$NL <- pheno$FLE - pheno$NL
pheno$FLE <- pheno$FOF - pheno$FLE
pheno$FOF <- pheno$FLCC - pheno$FOF
pheno$FLCC <- pheno$EOS - pheno$FLCC
rm(list = ls())
library(lme4)
library(lmerTest)
library(car)
library(emmeans)
library(MuMIn)
source("/Users/chelseawilmer/Desktop/Github/Phenology/Phenology.data.cleanup.R")
model1 <- lmer(NL ~ Site*Year*Treatment + Species + (1|PlotPair) + (1|Plot_ID) + (1|Subplot_ID), data = pheno)
anova(model1, ddf = "Kenward-Roger")
pheno <- filter(pheno, Site == "LM" | Site == "UM" | Site == "LSA" | Site == "USA")
model1 <- lmer(NL ~ Site*Year*Treatment + Species + (1|PlotPair) + (1|Plot_ID) + (1|Subplot_ID), data = pheno)
rm(list = ls())
library(lme4)
library(lmerTest)
library(car)
library(emmeans)
library(MuMIn)
source("/Users/chelseawilmer/Desktop/Github/Phenology/Phenology.data.cleanup.R")
str(pheno)
#make variables factors
pheno$Year <- as.factor(pheno$Year)
pheno$Site <- as.factor(pheno$Site)
pheno$PlotPair <- as.factor(pheno$PlotPair)
pheno$Plot_ID <- as.factor(pheno$Plot_ID)
pheno$Subplot_ID <- as.factor(pheno$Subplot_ID)
pheno$Treatment <- as.factor(pheno$Treatment)
pheno$Species <- as.factor(pheno$Species)
pheno$Functional.Type <- as.factor(pheno$Functional.Type)
pheno$Elevation <- as.integer(pheno$Elevation)
pheno$NL <- pheno$FLE - pheno$NL
pheno$FLE <- pheno$FOF - pheno$FLE
pheno$FOF <- pheno$FLCC - pheno$FOF
pheno$FLCC <- pheno$EOS - pheno$FLCC
pheno
rm(list = ls())
library(tidyverse)
library(tidyverse)
library(tidyverse)
library(effects)
library(gridExtra)
source("/Users/chelseawilmer/Desktop/Github/Phenology/Phenology.data.cleanup.R")
#make variables factors
pheno$Year <- as.factor(pheno$Year)
pheno$Site <- as.factor(pheno$Site)
pheno$PlotPair <- as.factor(pheno$PlotPair)
pheno$Plot_ID <- as.factor(pheno$Plot_ID)
pheno$Subplot_ID <- as.factor(pheno$Subplot_ID)
pheno$Treatment <- as.factor(pheno$Treatment)
pheno$Species <- as.factor(pheno$Species)
pheno$Functional.Type <- as.factor(pheno$Functional.Type)
pheno$Elevation <- as.integer(pheno$Elevation)
pheno <- select(pheno, -c(Plot, Subplot, Duplicate.Plot, FBB, FLB))
duration <- pheno
duration$NL <- duration$FLE - duration$NL
duration$FLE <- duration$FOF - duration$FLE
duration$FOF <- duration$FLCC - duration$FOF
duration$FLCC <- duration$EOS - duration$FLCC
#interaction plots
qplot(x = DOYsf, y = FLE, color = factor(Elevation), data = pheno) +
geom_smooth(method = lm, se = FALSE, fullrange = T)
qplot(x = Elevation, y = FLE, color = factor(DOYsf), data = pheno) +
geom_smooth(method = lm, se = FALSE, fullrange = T)
#interaction plots
qplot(x = DOYsf, y = NL, color = factor(Elevation), data = pheno) +
geom_smooth(method = lm, se = FALSE, fullrange = T)
qplot(x = DOYsf, y = FOF, color = factor(Elevation), data = pheno) +
geom_smooth(method = lm, se = FALSE, fullrange = T)
qplot(x = DOYsf, y = FLCC, color = factor(Elevation), data = pheno) +
geom_smooth(method = lm, se = FALSE, fullrange = T)
rm(list = ls())
library(tidyverse)
library(lme4)
library(lmerTest)
library(emmeans)
library(effects)
library(gridExtra)
source("/Users/chelseawilmer/Desktop/Github/Phenology/Phenology.data.cleanup.R")
#make variables factors
pheno$Year <- as.factor(pheno$Year)
pheno$Site <- as.factor(pheno$Site)
pheno$PlotPair <- as.factor(pheno$PlotPair)
pheno$Plot_ID <- as.factor(pheno$Plot_ID)
pheno$Subplot_ID <- as.factor(pheno$Subplot_ID)
pheno$Treatment <- as.factor(pheno$Treatment)
pheno$Species <- as.factor(pheno$Species)
pheno$Functional.Type <- as.factor(pheno$Functional.Type)
pheno$Elevation <- as.integer(pheno$Elevation)
pheno <- select(pheno, -c(Plot, Subplot, Duplicate.Plot, FBB, FLB))
duration <- pheno
duration$NL <- duration$FLE - duration$NL
duration$FLE <- duration$FOF - duration$FLE
duration$FOF <- duration$FLCC - duration$FOF
duration$FLCC <- duration$EOS - duration$FLCC
#interaction plots
qplot(x = DOYsf, y = NL, color = factor(Elevation), data = pheno) +
geom_smooth(method = lm, se = FALSE, fullrange = T)
qplot(x = DOYsf, y = FLE, color = factor(Elevation), data = pheno) +
geom_smooth(method = lm, se = FALSE, fullrange = T)
qplot(x = DOYsf, y = FOF, color = factor(Elevation), data = pheno) +
geom_smooth(method = lm, se = FALSE, fullrange = T)
qplot(x = DOYsf, y = FOF, color = factor(Elevation), data = pheno) +
geom_smooth(method = lm, se = FALSE, fullrange = T)
qplot(x = DOYsf, y = FLCC, color = factor(Elevation), data = pheno) +
geom_smooth(method = lm, se = FALSE, fullrange = T)
model1 <- lmer(NL ~ DOYsf*Elevation + Species + (1|PlotPair) + (1|Plot_ID) + (1|Subplot_ID), data = pheno)
plot(effect(term = "DOYsf:Elevation", mod = model1, default.levels = 5), multiline = TRUE)
anova(model1, ddf = "Kenward-Roger")
pheno$sfe <- mutate(sfe = DOYsf*Elevation)
View(pheno)
pheno$sfe <- pheno$DOYsf*pheno$Elevation
View(pheno)
model1 <- lmer(NL ~ DOYsf*Elevation + sfe + Species + (1|PlotPair) + (1|Plot_ID) + (1|Subplot_ID), data = pheno)
View(pheno)
model1 <- lmer(NL ~ DOYsf*Elevation + Species + sfe + (1|PlotPair) + (1|Plot_ID) + (1|Subplot_ID), data = pheno)
rm(list = ls())
library(tidyverse)
library(lme4)
library(lmerTest)
library(emmeans)
library(effects)
library(gridExtra)
source("/Users/chelseawilmer/Desktop/Github/Phenology/Phenology.data.cleanup.R")
#make variables factors
pheno$Year <- as.factor(pheno$Year)
pheno$Site <- as.factor(pheno$Site)
pheno$PlotPair <- as.factor(pheno$PlotPair)
pheno$Plot_ID <- as.factor(pheno$Plot_ID)
pheno$Subplot_ID <- as.factor(pheno$Subplot_ID)
pheno$Treatment <- as.factor(pheno$Treatment)
pheno$Species <- as.factor(pheno$Species)
pheno$Functional.Type <- as.factor(pheno$Functional.Type)
pheno$Elevation <- as.integer(pheno$Elevation)
pheno <- select(pheno, -c(Plot, Subplot, Duplicate.Plot, FBB, FLB))
duration <- pheno
duration$NL <- duration$FLE - duration$NL
duration$FLE <- duration$FOF - duration$FLE
duration$FOF <- duration$FLCC - duration$FOF
duration$FLCC <- duration$EOS - duration$FLCC
model1 <- lmer(NL ~ DOYsf*Elevation + Species (1|PlotPair) + (1|Plot_ID) + (1|Subplot_ID), data = pheno)
model1 <- lmer(NL ~ DOYsf*Elevation + Species + (1|PlotPair) + (1|Plot_ID) + (1|Subplot_ID), data = pheno)
doysf <- data.frame(Yhat = predict(model1), pheno)
doysf <- data.frame(Yhat = predict(model1), pheno)
coef(summary(model1))
summary(model1)
summary(model2)
emtrends(model1, pairwise ~ Elevation, var="DOYsf")
emtrends(model1, pairwise ~ DOYsf, var="Elevation")
emtrends(model1, pairwise ~ Elevation)
emtrends(model1, pairwise ~ Elevation, var="Elevation")
emtrends(model1, pairwise ~ Elevation, var="DOYsf")
model1 <- lmer(NL ~ Treatment*Elevation + Species + (1|PlotPair) + (1|Plot_ID) + (1|Subplot_ID), data = pheno)
anova(model1, ddf = "Kenward-Roger")
emtrends(model1, pairwise ~ Elevation, var="Treatment")
emtrends(model1, pairwise ~ Treatment, var="Elevation")
model1 <- lmer(NL ~ DOYsf*Site + Species + (1|PlotPair) + (1|Plot_ID) + (1|Subplot_ID), data = pheno)
anova(model1, ddf = "Kenward-Roger")
emtrends(model1, pairwise ~ Site, var="DOYsf")
model1 <- lmer(NL ~ Treatment*Elevation + Species + (1|PlotPair) + (1|Plot_ID) + (1|Subplot_ID), data = pheno)
anova(model1, ddf = "Kenward-Roger")
emtrends(model1, pairwise ~ Treatment, var="Elevation")
model2 <- lmer(FLE ~ Treatment*Elevation + Species + (1|PlotPair) + (1|Plot_ID) + (1|Subplot_ID), data = pheno)
emtrends(model2, pairwise ~ Treatment, var="Elevation")
model1 <- lmer(NL ~ DOYsf*Site + Species + (1|PlotPair) + (1|Plot_ID) + (1|Subplot_ID), data = pheno)
emtrends(model1, pairwise ~ Treatment, var="Elevation")
emtrends(model1, pairwise ~ Site, var="DOYsf")
rm(list = ls())
library(tidyverse)
library(tidyverse)
library(lme4)
library(lmerTest)
library(emmeans)
library(effects)
library(gridExtra)
source("/Users/chelseawilmer/Desktop/Github/Phenology/Phenology.data.cleanup.R")
library(gridExtra)
source("/Users/chelseawilmer/Desktop/Github/Phenology/Phenology.data.cleanup.R")
pheno <- select(pheno, -c(Plot, Subplot, Duplicate.Plot, FBB, FLB))
pheno <- select(pheno, -c(Plot, Subplot, Duplicate.Plot, FBB, FLB))
pheno <- select(pheno, -c(Plot, Subplot, FBB, FLB))
duration <- pheno
duration$NL <- duration$FLE - duration$NL
duration$FLE <- duration$FOF - duration$FLE
duration$FOF <- duration$FLCC - duration$FOF
duration$FLCC <- duration$EOS - duration$FLCC
#interaction plots
qplot(x = DOYsf, y = NL, color = factor(Elevation), data = pheno) +
geom_smooth(method = lm, se = FALSE, fullrange = T)
qplot(x = DOYsf, y = FLE, color = factor(Elevation), data = pheno) +
geom_smooth(method = lm, se = FALSE, fullrange = T)
qplot(x = DOYsf, y = FOF, color = factor(Elevation), data = pheno) +
geom_smooth(method = lm, se = FALSE, fullrange = T)
qplot(x = DOYsf, y = FLCC, color = factor(Elevation), data = pheno) +
geom_smooth(method = lm, se = FALSE, fullrange = T)
rm(list = ls())
library(tidyverse)
library(lme4)
library(lmerTest)
library(emmeans)
library(effects)
library(gridExtra)
source("/Users/chelseawilmer/Desktop/Github/Phenology/Phenology.data.cleanup.R")
pheno$Year <- as.factor(pheno$Year)
pheno$Site <- as.factor(pheno$Site)
pheno$PlotPair <- as.factor(pheno$PlotPair)
pheno$Plot_ID <- as.factor(pheno$Plot_ID)
pheno$Subplot_ID <- as.factor(pheno$Subplot_ID)
pheno$Treatment <- as.factor(pheno$Treatment)
pheno$Species <- as.factor(pheno$Species)
pheno$Functional.Type <- as.factor(pheno$Functional.Type)
pheno$Elevation <- as.integer(pheno$Elevation)
pheno <- select(pheno, -c(Plot, Subplot, FBB, FLB))
duration <- pheno
duration$NL <- duration$FLE - duration$NL
duration$FLE <- duration$FOF - duration$FLE
duration$FOF <- duration$FLCC - duration$FOF
duration$FLCC <- duration$EOS - duration$FLCC
#interaction plots
qplot(x = DOYsf, y = NL, color = factor(Elevation), data = pheno) +
geom_smooth(method = lm, se = FALSE, fullrange = T)
#interaction plots
qplot(x = DOYsf, y = NL, shape = Year, color = factor(Elevation), data = pheno) +
geom_smooth(method = lm, se = FALSE, fullrange = T)
#interaction plots
qplot(x = DOYsf, y = NL, color = factor(Elevation), data = pheno) +
geom_smooth(method = lm, se = FALSE, fullrange = T)
model1 <- lmer(NL ~ DOYsf*Elevation + Species + (1|PlotPair) + (1|Plot_ID) + (1|Subplot_ID), data = pheno)
plot(effect(term = "DOYsf:Elevation", mod = model1, default.levels = 5), multiline = TRUE)
model1 <- lmer(NL ~ DOYsf*Site + Species + (1|PlotPair) + (1|Plot_ID) + (1|Subplot_ID), data = pheno)
plot(effect(term = "DOYsf:Elevation", mod = model1, default.levels = 5), multiline = TRUE)
model4 <- lmer(FLE ~ DOYsf*Elevation + Species + (1|PlotPair) + (1|Plot_ID) + (1|Subplot_ID), data = pheno)
plot(effect(term = "DOYsf:Elevation", mod = model2, default.levels = 5), multiline = TRUE)
plot(effect(term = "DOYsf:Elevation", mod = model4, default.levels = 5), multiline = TRUE)
model5 <- lmer(FOF ~ DOYsf*Elevation + Species + (1|PlotPair) + (1|Plot_ID) + (1|Subplot_ID), data = pheno)
plot(effect(term = "DOYsf:Elevation", mod = model5, default.levels = 5), multiline = TRUE)
model6 <- lmer(FLCC ~ DOYsf*Elevation + Species + (1|PlotPair) + (1|Plot_ID) + (1|Subplot_ID), data = pheno)
plot(effect(term = "DOYsf:Elevation", mod = model6, default.levels = 5), multiline = TRUE)
anova(model1, ddf = "Kenward-Roger")
anova(model1, ddf = "Kenward-Roger")
summary(model1)
model1 <- lmer(NL ~ DOYsf*Elevation + Species + (1|PlotPair) + (1|Plot_ID) + (1|Subplot_ID), data = pheno)
rm(list = ls())
library(tidyverse)
library(lme4)
library(lmerTest)
library(emmeans)
library(effects)
library(gridExtra)
source("/Users/chelseawilmer/Desktop/Github/Phenology/Phenology.data.cleanup.R")
str(pheno)
#make variables factors
pheno$Year <- as.factor(pheno$Year)
pheno$Site <- as.factor(pheno$Site)
pheno$PlotPair <- as.factor(pheno$PlotPair)
pheno$Plot_ID <- as.factor(pheno$Plot_ID)
pheno$Subplot_ID <- as.factor(pheno$Subplot_ID)
pheno$Treatment <- as.factor(pheno$Treatment)
pheno$Species <- as.factor(pheno$Species)
pheno$Functional.Type <- as.factor(pheno$Functional.Type)
pheno$Elevation <- as.integer(pheno$Elevation)
pheno <- select(pheno, -c(Plot, Subplot, FBB, FLB))
duration <- pheno
duration$NL <- duration$FLE - duration$NL
duration$FLE <- duration$FOF - duration$FLE
duration$FOF <- duration$FLCC - duration$FOF
duration$FLCC <- duration$EOS - duration$FLCC
model1 <- lmer(NL ~ DOYsf*Elevation + Species + (1|PlotPair) + (1|Plot_ID) + (1|Subplot_ID), data = pheno)
summary(model1)
model2 <- lmer(NL ~ DOYsf*Site + Species + (1|PlotPair) + (1|Plot_ID) + (1|Subplot_ID), data = pheno)
emtrends(model1, pairwise ~ Site, var="DOYsf")
emtrends(model2, pairwise ~ Site, var="DOYsf")
model7 <- lmer(FLE ~ DOYsf*Site + Species + (1|PlotPair) + (1|Plot_ID) + (1|Subplot_ID), data = pheno)
emtrends(model7, pairwise ~ Site, var="DOYsf")
model7 <- lmer(FOF ~ DOYsf*Site + Species + (1|PlotPair) + (1|Plot_ID) + (1|Subplot_ID), data = pheno)
emtrends(model7, pairwise ~ Site, var="DOYsf")
model3 <- lmer(NL ~ Treatment*Elevation + Species + (1|PlotPair) + (1|Plot_ID) + (1|Subplot_ID), data = pheno)
emtrends(model3, pairwise ~ Treatment, var="Elevation")
emtrends(model2, pairwise ~ Site, var="DOYsf", at=list(Treatment="Early")
emtrends(model2, pairwise ~ Site, var="DOYsf", at=list(Treatment="Early"))
emtrends(model2, pairwise ~ Site, var="DOYsf", at=list(Treatment = "Early"))
rm(list = ls())
## Date: 2020-04-10
## User: Chelsea Wilmer
## SFA/CSU Thesis
## Script: Calculating the timing of events for the effect the treatment
## Packages:
library(tidyverse)
library(ggpubr)
####Bring in phenology data####
source("/Users/chelseawilmer/Desktop/Github/Phenology/Phenology.data.cleanup.R")
# path for Dana
#source("Phenology.data.cleanup.R")
#remove columns that we don't need
pheno <- select(pheno, -c(Duplicate.Plot, FBB, FLB, Plot))
#filter pheno dataset for the treatment year 2018
treatment <- filter(pheno, Year == 2018)
treatment <- filter(treatment, Site == "LM" | Site == "UM" | Site == "LSA" | Site == "USA")
#reorder dataset to be longer (events are in an 'event' column instead of columns of their own)
treatment <- treatment %>%
pivot_longer(cols = c("NL", "FLE", "FOF","FLCC"),
names_to = "Event", values_to = "DOY")
#calculate means by block
treatment <- treatment%>%
group_by(Site, Block, Treatment, Species, Event)%>%
summarise(meanDOY = mean(DOY, na.rm = T))
treatment_stats <- na.omit(treatment)
#calculate means by treatment
treatment <- treatment%>%
group_by(Site, Treatment, Species, Event)%>%
summarise(meanDOY = mean(meanDOY, na.rm = T))
treatment <- treatment%>%
pivot_wider(names_from = Treatment, values_from = meanDOY)
#calculate treatment effect
treatment$effect <- treatment$Treatment - treatment$Control
rm(list = ls())
## Date: 2021-02-18
## User: Chelsea Wilmer
## SFA/CSU Thesis
## Script: percent species early graphs for elevations
## Packages:
library(tidyverse)
library(ggpubr)
####Bring in phenology data####
source("/Users/chelseawilmer/Desktop/Github/Phenology/Phenology.data.cleanup.R")
# path for Dana
#source("Phenology.data.cleanup.R")
#remove columns that we don't need
pheno <- select(pheno, -c(Duplicate.Plot, FBB, FLB, Plot))
#filter pheno dataset for the control plots to make effect of the year dataset
year <- filter(pheno, Treatment == "Control")
#filter pheno dataset for 2018 to make the effect of the treatment dataset
treatment <- filter(pheno, Year == 2018)
treatment <- filter(treatment, Site == "LM" | Site == "UM" | Site == "LSA" | Site == "USA")
####YEAR####
#reorder dataset to be longer (events are in an 'event' column instead of columns of their own)
year <- year %>%
pivot_longer(cols = c("NL", "FLE", "FOF","FLCC"),
names_to = "Event", values_to = "DOY")
#average over subplots
year <- year%>%
group_by(Year, Site, Block, Treatment, Species, EOS, Event)%>%
summarise(meanDOY = mean(DOY, na.rm = T))
year <- year%>%
group_by(Year, Site, Treatment, Species, EOS, Event)%>%
summarise(meanDOY = mean(meanDOY, na.rm = T))
year <- year%>%
group_by(Year, Site, Treatment, EOS, Event)%>%
summarise(meanDOY = mean(meanDOY, na.rm = T))
year_duration <- year%>%
pivot_wider(names_from = Event, values_from = meanDOY)
year_duration$NL <- year_duration$FLE - year_duration$NL
year_duration$FLE <- year_duration$FOF - year_duration$FLE
year_duration$FOF <- year_duration$FLCC - year_duration$FOF
year_duration$FLCC <- year_duration$EOS - year_duration$FLCC
year_duration <- year_duration%>%
pivot_longer(cols = c("NL", "FLE", "FOF", "FLCC"),
names_to = "Event", values_to = "Duration")
year <- year%>%
group_by(Year, Site, Event)%>%
summarise(meanDOY = mean(meanDOY, na.rm = T))
year_duration <- year_duration%>%
group_by(Year, Site, Event)%>%
summarise(Duration = mean(Duration, na.rm = T))
#reorder dataset to be longer (events are in an 'event' column instead of columns of their own)
treatment <- treatment%>%
group_by(Site, Block, Treatment, EOS, Species)%>%
summarise(NL = mean(NL, na.rm = T),
FLE = mean(FLE, na.rm = T),
FOF = mean(FOF, na.rm = T),
FLCC = mean(FLCC, na.rm = T))
treatment <- treatment %>%
pivot_longer(cols = c("NL", "FLE", "FOF","FLCC"),
names_to = "Event", values_to = "DOY")
#calculate means by block
treatment <- treatment%>%
group_by(Site, Block, Treatment, Species, EOS, Event)%>%
summarise(meanDOY = mean(DOY, na.rm = T))
treatment <- treatment%>%
group_by(Site, Treatment, Species, EOS, Event)%>%
summarise(meanDOY = mean(meanDOY, na.rm = T))
treatment <- treatment%>%
group_by(Site, Treatment, EOS, Event)%>%
summarise(meanDOY = mean(meanDOY, na.rm = T))
treatment_duration <- treatment%>%
pivot_wider(names_from = Event, values_from = meanDOY)
treatment_duration$NL <- treatment_duration$FLE - treatment_duration$NL
treatment_duration$FLE <- treatment_duration$FOF - treatment_duration$FLE
treatment_duration$FOF <- treatment_duration$FLCC - treatment_duration$FOF
treatment_duration$FLCC <- treatment_duration$EOS - treatment_duration$FLCC
treatment_duration <- treatment_duration%>%
pivot_longer(cols = c("NL", "FLE", "FOF", "FLCC"),
names_to = "Event", values_to = "Duration")
treatment <- treatment%>%
group_by(Site, Treatment, Event)%>%
summarise(meanDOY = mean(meanDOY, na.rm = T))
treatment_duration <- treatment_duration%>%
group_by(Site, Treatment, Event)%>%
summarise(Duration = mean(Duration, na.rm = T))
#combine
trmt <- left_join(treatment, treatment_duration, by = c("Site", "Treatment", "Event"))
yr <- left_join(year, year_duration, by = c("Year", "Site", "Event"))
####Timing x Duration####
#year split by event
yr$Year <- as.factor(yr$Year)
nl <- yr%>%
filter(Event == "NL")%>%
ggplot(aes(Duration, meanDOY, color = Year, shape = Site))+
geom_point()+
labs(title = "New Leaves")
fle <- yr%>%
filter(Event == "FLE")%>%
ggplot(aes(Duration, meanDOY, color = Year, shape = Site))+
geom_point()+
labs(title = "Full Leaf Expansion")
fof <- yr%>%
filter(Event == "FOF")%>%
ggplot(aes(Duration, meanDOY, color = Year, shape = Site))+
geom_point()+
labs(title = "First Open Flower")
flcc <- yr%>%
filter(Event == "FLCC")%>%
ggplot(aes(Duration, meanDOY, color = Year, shape = Site))+
geom_point()+
labs(title = "Full Leaf Color Change")
ggarrange(nl, fle, fof, flcc, nrow = 3, ncol = 2, common.legend = T, legend = "right")
#year split by site
lm <- yr%>%
filter(Site == "LM")%>%
ggplot(aes(Duration, meanDOY, color = Year, shape = Event))+
geom_point()+
labs(title = "Lower Montane")
um <- yr%>%
filter(Site == "UM")%>%
ggplot(aes(Duration, meanDOY, color = Year, shape = Event))+
geom_point()+
labs(title = "Upper Montane")
lsa <- yr%>%
filter(Site == "LSA")%>%
ggplot(aes(Duration, meanDOY, color = Year, shape = Event))+
geom_point()+
labs(title = "Lower Subalpine")
usa <- yr%>%
filter(Site == "USA")%>%
ggplot(aes(Duration, meanDOY, color = Year, shape = Event))+
geom_point()+
labs(title = "Upper Subalpine")
alp <- yr%>%
filter(Site == "ALP")%>%
ggplot(aes(Duration, meanDOY, color = Year, shape = Event))+
geom_point()+
labs(title = "Alpine")
ggarrange(lm, um, lsa, usa, alp, nrow = 2, ncol = 3, common.legend = T, legend = "right")
ggarrange(lm, um, lsa, usa, alp, nrow = 3, ncol = 2, common.legend = T, legend = "right")
